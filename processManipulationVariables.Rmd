---
title: "Manipulation of Variables"
author: "Pedro Girardi"
date: "December 11, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(data.table)
```

## Importing STATA Exported .csvs and selecting variables of interest

```{r, eval=F}
setwd("PME_stata/")#set directory to where the STATA csv files are
listOfCsv = list.files()# get a list of all files

# create data frame with one of the files (Selecting for the variables of interest)
stataCsv = fread(file = listOfCsv[[1]]) %>% 
  select(v035, v040, v050, v070, v075, v203, v4191, v208,
         v301, v307, v234, vD23df, vD24df, vD25df, 
         vD26df, p201, idind) 

# runs for loop that reads one file and appends rows of columns of interest to previous df
for (fileCsv in listOfCsv[-1]){
  currentFile = fread(file = fileCsv) %>% 
  select(v035, v040, v050, v070, v203, v4191, v208,
         v301, v307, v234, vD23df, vD24df, vD25df, 
         vD26df, p201, idind)
  stataCsv = bind_rows(stataCsv, currentFile)
}
# fwrite(stataCsv, "finalPME.csv")
```

```{r, eval=F}
finalPME = fread("finalPME.csv")

# Sample 10% of households and select important columns
hhSample = sample(finalPME$idind, length(unique(finalPME$idind))/20, replace = F)
reducedPME = finalPME %>% filter(idind %in% hhSample)
fwrite(reducedPME, file = "reducedPME")
```

```{r Reading Reduced PME file}
reducedPME = fread("reducedPME")
```

## Flagging low income people

```{r}
reducedPME = redu

```

## Woring with income data

```{r}
summary(reducedPME$vD26df)

```
