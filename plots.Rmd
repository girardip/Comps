---
title: "EDA Plots"
author: "Pedro Girardi"
date: "February 5, 2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Summary plots

```{r}
library(stargazer)
library(tidyverse)
library(lubridate)
```

```{r loads Data}
load("finalModels.RData")
```

```{r}
View(head(complete.df))
```

```{r}
summary(complete.df)
# keep region, age, v4191, inflation, price index, inflationTax, changeInGDP, realWage, poorthreshold, gender, ethnicity, literacy, schooling, employment type
```
```{r, eval=F}
# creates subset of df for preliminary plotting
set.seed(1)
sampled.df = sample_n(complete.df, replace = F, size = nrow(complete.df)/20)
sampled.df = sampled.df %>% mutate(Date = ymd(Date))
```

```{r realWage x lagInflationTax}
ggplot(complete.df, aes(x=lagInflationTax, y=realWage)) +
  geom_point(aes(col=Gender)) +
  geom_smooth(method = "lm") +
  theme_minimal()

ggplot(complete.df, aes(x=lagInflationTax, y=realWage)) +
  geom_point(aes(col=Schooling)) +
  labs(title="Real Wage on Lag Inflation Tax, by Schooling", 
       y="Real Wage",
       x="Lag Inflation Tax") + 
  theme_minimal()
```

```{r}
ggplot(complete.df %>% mutate(Date = lubridate::ymd(Date)), aes(x=Date)) +
  geom_line(aes(y=PoorThreshold)) +
  labs(title="Change in Poverty Threshold (real wage)",
       y="Poor Threshold",
       x="Time") +
  theme_minimal()
# peak in poor threshold every january (readjusted minimum wage)

ggplot(complete.df %>% 
         mutate(Year = year(Date),
                Month = month(Date)),
       aes(x=Month, y=Inflation)) + 
  geom_line(aes(col=as.factor(paste0(Year, v035)))) +
  labs(title="Inflation Seasonality, colored by Region") +
  theme_minimal()+
  theme(legend.position="none")

#still can't explain peak and drop in poor threshold
# thought: maybe seasonality of GDP fucks up the analysis?
```

```{r}
ggplot(data = complete.df, aes(x=Ethnicity))+
  geom_bar(aes(fill=v035)) +
  labs(title="Observations per race, color by state", 
       y="Observations")+
  theme_minimal()

ggplot(data=complete.df, aes(x=nObsPoor)) +
  geom_histogram(aes(fill=Schooling), binwidth = .5) +
  labs(title="Number of observations below poverty threshold by Schooling",
       x="Observions below poverty threshold",
       y="Number of cases") +
  theme_minimal()
```
